from yumipy import YuMiRobot,YuMiMotionPlanner, YuMiState
from autolab_core import RigidTransform
y=YuMiRobot()
l_nice_state=YuMiState([-71.52785377, -62.91241387,  17.98294573, 108.93368164,  75.65987325,
 139.55185761,  61.09700753])
r_nice_state=YuMiState([  69.58162107,  -59.13245666,   17.11626609, -106.14485253,   71.82808192,
 -138.76000321,  -63.06703326])
y.set_v(150,200)#set speed (lienar mm/s, rotational deg/s)
raw_input("Enter to move left to home")
y.left.goto_state(l_nice_state)
raw_input("Enter to move right to home")
y.right.goto_state(r_nice_state)
raw_input('Enter to run waypoints')
l_waypoints=[
[-71.527854,-62.912414,17.982946,108.933682,75.659873,139.551858,61.097008],
[-71.460068,-64.963268,21.113450,109.985099,73.691359,135.942861,62.369340],
[-71.608975,-67.244438,24.071619,111.524078,71.893371,132.477616,63.735968],
[-71.781136,-69.373636,26.773613,113.278951,69.819750,129.045361,65.387185],
[-72.052622,-71.549258,29.258794,115.394908,67.751005,125.694971,67.214933],
[-72.423653,-73.847547,31.534330,117.895046,65.711679,122.510058,69.184695],
[-72.873187,-76.253605,33.587590,120.742535,63.774634,119.350979,71.290572],
[-73.372478,-78.762562,35.394787,123.880177,61.798271,116.335710,73.538592],
[-73.911778,-81.417978,36.960920,127.324413,59.881623,113.503724,75.890952],
[-74.474798,-84.254560,38.271067,131.019702,58.010267,110.882095,78.319952],
[-75.038761,-87.286032,39.310451,134.907926,56.160347,108.511166,80.800216],
[-75.579868,-90.514919,40.062923,138.920681,54.292775,106.426225,83.305632],
[-75.579868,-90.514919,40.062923,138.920681,54.292775,106.426225,83.305632],
[-70.212687,-87.569922,41.619692,133.961021,53.918675,110.095118,81.084009],
[-64.800890,-84.922847,42.543799,128.846892,53.257262,114.432230,78.642373],
[-59.425120,-82.641181,42.843014,123.642104,52.472110,119.468560,76.076402],
[-54.197922,-80.785355,42.533623,118.436198,51.748379,125.184543,73.476898],
[-49.252037,-79.398767,41.640113,113.352991,51.269349,131.495330,70.920365],
[-44.721855,-78.490896,40.191335,108.547858,51.180576,138.248767,68.463616],
[-40.719738,-78.020435,38.215062,104.183890,51.552356,145.248651,66.143925],
[-37.317102,-77.893579,35.733372,100.392413,52.363606,152.302028,63.982812],
[-34.540712,-77.985409,32.761062,97.242892,53.521725,159.265688,61.989354],
[-32.384335,-78.171709,29.305998,94.740908,54.904350,166.065976,60.161397],
[-30.825799,-78.351181,25.369018,92.847606,56.395627,172.690579,58.486123],
[-30.825799,-78.351181,25.369018,92.847606,56.395627,172.690579,58.486123],
[-32.708328,-75.942959,26.375969,94.238937,56.495411,168.092901,58.526639],
[-34.863655,-73.490070,27.013510,95.526789,56.817836,163.691347,58.579127],
[-37.530718,-71.475360,27.359242,96.954341,57.838689,159.608727,58.464322],
[-40.233017,-68.981455,27.249139,98.005217,58.529604,155.680094,58.681783],
[-43.213729,-66.499941,26.750755,98.873125,59.362596,152.111887,59.035156],
[-46.463923,-64.039238,25.873734,99.624146,60.234496,148.860238,59.579198],
[-49.997785,-61.607982,24.600860,100.168583,61.285720,145.966075,60.336502],
[-53.826391,-59.265325,22.955717,100.634822,62.341291,143.412801,61.349531],
[-57.961852,-57.030857,20.933782,101.006802,63.431203,141.212579,62.644942],
[-62.422957,-54.948211,18.539322,101.316036,64.550229,139.366993,64.241011],
[-67.229464,-53.070489,15.776681,101.602327,65.703241,137.876138,66.142980],
]
r_waypoints=[
[69.509161,-58.962755,17.077449,-106.020352,71.685891,-138.709448,-63.153395],
[69.492589,-61.528481,20.001250,-106.128063,69.095488,-137.605092,-64.064297],
[69.586417,-64.112653,22.698236,-106.428669,66.453071,-136.683267,-65.193651],
[69.770013,-66.729579,25.171707,-106.904277,63.754494,-135.977513,-66.519814],
[70.024497,-69.384556,27.419308,-107.524399,61.014159,-135.505851,-68.026194],
[70.332858,-72.081933,29.436281,-108.249579,58.244140,-135.292529,-69.696711],
[70.679220,-74.823744,31.215932,-109.029365,55.453552,-135.368703,-71.515453],
[71.048436,-77.607976,32.750051,-109.800175,52.647972,-135.773109,-73.466594],
[71.426137,-80.426584,34.029317,-110.483347,49.829036,-136.552654,-75.534699],
[71.799197,-83.263531,35.043846,-110.983349,46.994551,-137.763190,-77.705232],
[72.159332,-86.123571,35.796134,-111.280407,44.155405,-139.384795,-79.956373],
[72.492875,-88.897859,36.242814,-110.960741,41.274441,-141.762621,-82.295694],
[72.492875,-88.897859,36.242814,-110.960741,41.274441,-141.762621,-82.295694],
[68.816600,-86.812323,38.304605,-111.168376,43.272482,-140.360514,-80.603133],
[65.066511,-84.825260,40.070225,-110.922352,45.158572,-139.534510,-78.717632],
[61.250741,-82.968368,41.539454,-110.338971,46.928215,-139.212561,-76.665520],
[57.386990,-81.273722,42.713900,-109.524373,48.589686,-139.334384,-74.478503],
[53.502048,-79.767293,43.596775,-108.576136,50.156475,-139.844755,-72.194599],
[49.639793,-78.498497,44.208196,-107.696187,51.659035,-140.605944,-69.853277],
[45.818790,-77.396231,44.511005,-106.632643,53.082354,-141.824851,-67.504108],
[42.091316,-76.501191,44.551215,-105.777337,54.430377,-143.182212,-65.198362],
[38.493620,-75.787236,44.324361,-105.080976,55.710022,-144.720435,-62.974246],
[35.059466,-75.228341,43.838412,-104.587299,56.914326,-146.393548,-60.868906],
[31.816890,-74.794280,43.101575,-104.327825,58.032554,-148.160217,-58.912049],
[31.816890,-74.794280,43.101575,-104.327825,58.032554,-148.160217,-58.912049],
[34.688567,-72.750740,41.662391,-104.442591,59.094261,-146.085984,-58.627585],
[37.622263,-70.727598,40.008577,-104.472971,60.131355,-144.266998,-58.501597],
[40.621010,-68.736528,38.146538,-104.435346,61.137242,-142.696234,-58.540219],
[43.690296,-66.789337,36.082445,-104.345212,62.108457,-141.365910,-58.747678],
[46.828380,-64.883326,33.829581,-104.280929,63.016079,-140.228113,-59.134532],
[50.068989,-63.067189,31.368053,-104.060140,63.937606,-139.393184,-59.680273],
[53.395689,-61.311528,28.733106,-103.940267,64.791926,-138.695361,-60.409874],
[56.848992,-59.675982,25.899933,-103.733152,65.652652,-138.291143,-61.297644],
[60.424539,-58.146099,22.888829,-103.592738,66.488233,-138.051533,-62.353734],
[64.141334,-56.747342,19.691906,-103.488404,67.318900,-138.012809,-63.565892],
[68.012964,-55.499091,16.306132,-103.439663,68.155242,-138.172046,-64.921709],
]

y.left.joint_buffer_clear()
y.right.joint_buffer_clear()
for i in range(len(r_waypoints)):
	# raw_input("go?")
	# y.left.goto_state(YuMiState(l_waypoints[i]),wait_for_res=False)
	# y.right.goto_state(YuMiState(r_waypoints[i]))
	y.left.joint_buffer_add(YuMiState(l_waypoints[i]))
	y.right.joint_buffer_add(YuMiState(r_waypoints[i]))
y.left.joint_buffer_execute(wait_for_res=False)
y.right.joint_buffer_execute()
# l_planner=YuMiMotionPlanner('left','gripper_l_base',planning_time=.5,planner="RRTstar")
# y.left.set_motion_planner(l_planner)
# start_state=y.left.get_state()
# start_pose = y.left.get_pose().as_frames("gripper","world")
# reoriented = RigidTransform(translation=(.5,-.1,.1),rotation=[0.0018,-.85,-.464,-.249],from_frame='gripper',to_frame='world')#home pose for left arm only
# flat = RigidTransform(translation=(.5,-.1,.1),rotation=[0,1,0,0],from_frame='gripper',to_frame='world')#home pose for left arm only
# HOME_POSE = RigidTransform(translation=(.5,.2,.1),rotation=[0,1,0,0],from_frame='gripper',to_frame='world')
# CLOSE_POSE=RigidTransform(translation=(.2,-.1,.1),rotation=[0,1,0,0],from_frame='gripper',to_frame='world')
# waypoints=[start_pose,HOME_POSE]
# fraction,path=l_planner.plan_waypoints(start_state,waypoints)
# y.left.joint_buffer_clear()
# for state in path:
# 	# raw_input("x")
# 	y.left.goto_state(state)
# # 	y.left.joint_buffer_add(state)
# # y.left.joint_buffer_execute()